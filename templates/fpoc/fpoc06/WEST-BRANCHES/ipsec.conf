# IPsec

################ HUB 1 #############################################################

config vpn ipsec phase1-interface
    edit "H1_INET1"
        set interface "Internet_1"
        set ike-version 2
        set network-overlay enable
        set network-id 11
        set peertype any
        set localid "FGT-W-BR{{branch_id}}_INET1"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        set remote-gw {{dc1_inet1}}
        set psksecret 111111
    next
end

config vpn ipsec phase2-interface
    edit "H1_INET1"
        set phase1name "H1_INET1"
    next
end

config system interface
    edit "H1_INET1"
        set allowaccess ping
    next
end


####

config vpn ipsec phase1-interface
    edit "H1_INET2"
        set interface "Internet_2"
        set ike-version 2
        set network-overlay enable
        set network-id 12
        set peertype any
        set localid "FGT-W-BR{{branch_id}}_INET2"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        set remote-gw {{dc1_inet2}}
        set psksecret 121212
    next
end

config vpn ipsec phase2-interface
    edit "H1_INET2"
        set phase1name "H1_INET2"
    next
end

config system interface
    edit "H1_INET2"
        set allowaccess ping
    next
end


####

config vpn ipsec phase1-interface
    edit "H1_MPLS"
        set interface "MPLS"
        set ike-version 2
        set network-overlay enable
        set network-id 13
        set peertype any
        set localid "FGT-W-BR{{branch_id}}_MPLS"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        set remote-gw {{dc1_mpls}}
        set psksecret 131313
    next
end

config vpn ipsec phase2-interface
    edit "H1_MPLS"
        set phase1name "H1_MPLS"
    next
end

config system interface
    edit "H1_MPLS"
        set allowaccess ping
    next
end

################ HUB 2 #############################################################

config vpn ipsec phase1-interface
    edit "H2_INET1"
        set interface "Internet_1"
        set ike-version 2
        set network-overlay enable
        set network-id 21
        set peertype any
        set localid "FGT-W-BR{{branch_id}}_INET1"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        set remote-gw {{dc2_inet1}}
        set psksecret 212121
    next
end

config vpn ipsec phase2-interface
    edit "H2_INET1"
        set phase1name "H2_INET1"
    next
end

config system interface
    edit "H2_INET1"
        set allowaccess ping
    next
end


####

config vpn ipsec phase1-interface
    edit "H2_INET2"
        set interface "Internet_2"
        set ike-version 2
        set network-overlay enable
        set network-id 22
        set peertype any
        set localid "FGT-W-BR{{branch_id}}_INET2"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        set remote-gw {{dc2_inet2}}
        set psksecret 222222
    next
end

config vpn ipsec phase2-interface
    edit "H2_INET2"
        set phase1name "H2_INET2"
    next
end

config system interface
    edit "H2_INET2"
        set allowaccess ping
    next
end


####

config vpn ipsec phase1-interface
    edit "H2_MPLS"
        set interface "MPLS"
        set ike-version 2
        set network-overlay enable
        set network-id 23
        set peertype any
        set localid "FGT-W-BR{{branch_id}}_MPLS"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        set remote-gw {{dc2_mpls}}
        set psksecret 232323
    next
end

config vpn ipsec phase2-interface
    edit "H2_MPLS"
        set phase1name "H2_MPLS"
    next
end

config system interface
    edit "H2_MPLS"
        set allowaccess ping
    next
end
