{% load humanize %}

# CLI script for {{name}} running FortiOS {{fos_version}} ({{FOS|intcomma}})

config system global
    set admin-https-redirect disable
    set admintimeout 480
    set timezone 28
end

config system settings
    set gui-allow-unnamed-policy enable
    set gui-multiple-interface-policy enable
end

config system console
    set output standard
end

{% if FOS >= 6_002_000 %}
# For FortiOS >= 6.2: Need to configure FPoC with password 'fortinet' at the global configuration level of FortiPOC
config system admin
    edit "admin"
        unset password fortinet
    next
end
{% endif %}


# RFC 1918 addresses

config firewall address
    edit "RFC1918-10.0.0.0/8"
        set subnet 10.0.0.0 255.0.0.0
        set allow-routing enable
    next
    edit "RFC1918-172.16.0.0/12"
        set subnet 172.16.0.0 255.240.0.0
        set allow-routing enable
    next
    edit "RFC1918-192.168.0.0/16"
        set subnet 192.168.0.0 255.255.0.0
        set allow-routing enable
    next
end

config firewall addrgrp
    edit "RFC1918-private-subnets"
        set member "RFC1918-10.0.0.0/8" "RFC1918-172.16.0.0/12" "RFC1918-192.168.0.0/16"
        set allow-routing enable
    next
end
