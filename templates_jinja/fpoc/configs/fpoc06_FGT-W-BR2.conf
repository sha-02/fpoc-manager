# fpoc06 FGT-W-BR2 FortiOS 7.0.3
# context = {'branch_id': 2, 'region': 'West', 'local_ASN_FOS7': 65012, 'remote_ASN_FOS7': 65003, 'local_ASN_FOS6': 65000, 'remote_ASN_FOS6': 65000, 'remote_internet': 'mpls', 'cross_region_advpn': True, 'datacenter': {'west': {'first': {'id': 1, 'inet1': '100.64.11.1', 'inet2': '100.64.12.1', 'mpls': '10.0.14.1'}, 'second': {'id': 2, 'inet1': '100.64.21.2', 'inet2': '100.64.22.2', 'mpls': '10.0.24.2'}}, 'east': {'first': {'id': 3, 'inet1': '100.64.21.3', 'inet2': '100.64.22.3', 'mpls': '10.0.24.3'}, 'second': {'id': 4, 'inet1': '100.64.21.4', 'inet2': '100.64.22.4', 'mpls': '10.0.24.4'}}}, 'name': 'FGT-W-BR2', 'fos_version': '7.0.3', 'FOS': 7000003, 'mgmt_fpoc': '172.16.31.254', 'HA': FortiGate_HA(mode=<Modes.STANDALONE: 0>, role=<Roles.STANDALONE: 0>, group_id=None, group_name=None, hbdev=None, sessyncdev=None, monitordev=None, priority=None), 'wan': WAN(inet=WanSettings(port='port1', vlanid=0, subnet='100.64.40'), inet_snat=WanSettings(port='port1', vlanid=200, subnet='192.168.200'), inet_dnat=WanSettings(port='port1', vlanid=201, subnet='192.168.201'), inet1=WanSettings(port='port1', vlanid=41, subnet='100.64.41'), inet1_snat=WanSettings(port='port1', vlanid=210, subnet='192.168.210'), inet1_dnat=WanSettings(port='port1', vlanid=211, subnet='192.168.211'), inet2=WanSettings(port='port1', vlanid=42, subnet='100.64.42'), inet2_snat=WanSettings(port='port1', vlanid=220, subnet='192.168.220'), inet2_dnat=WanSettings(port='port1', vlanid=221, subnet='192.168.221'), inet3=WanSettings(port='port1', vlanid=43, subnet='100.64.43'), inet3_snat=WanSettings(port='port1', vlanid=230, subnet='192.168.230'), inet3_dnat=WanSettings(port='port1', vlanid=231, subnet='192.168.231'), mpls1=WanSettings(port='port2', vlanid=44, subnet='10.0.44'), mpls2=WanSettings(port='port2', vlanid=45, subnet='10.0.45')), 'request': <WSGIRequest: POST '/poc/6/'>, 'csrf_input': '<input type="hidden" name="csrfmiddlewaretoken" value="VLc3sv0wIva1ugH18JZeOcI0qXzbF8zNKbuSHY3rFGMrAqcTmvlpE5nA6bl5yd1n">', 'csrf_token': 'tGhizDHROaVnc4KlfMYO4K0RZxTW3zkli6z7O6KMLlxNiefdtykZUDFrFLFQWEMV'}
#
##################################################



config system global
    set hostname FGT-W-BR2
    
end

config system alias
    edit "sniff_client1"
        set command "diagnose sniffer packet any \'host 10.0.1.101\' 4"
    next
    edit "sniff_client2"
        set command "diagnose sniffer packet any \'host 10.0.2.101\' 4"
    next
    edit "sniff_client3"
        set command "diagnose sniffer packet any \'host 10.0.3.101\' 4"
    next
    edit "flow_client1"
        set command "
diag debug flow filter clear
diag debug flow show function-name enable
diag debug flow filter addr 10.0.1.101
diag debug flow trace start 5
diag debug console time enable
diag debug enable"
    next
    edit "flow_client2"
        set command "
diag debug flow filter clear
diag debug flow show function-name enable
diag debug flow filter addr 10.0.2.101
diag debug flow trace start 5
diag debug console time enable
diag debug enable"
    next
    edit "flow_client3"
        set command "
diag debug flow filter clear
diag debug flow show function-name enable
diag debug flow filter addr 10.0.3.101
diag debug flow trace start 5
diag debug console time enable
diag debug enable"
    next
    edit "flow_stop"
        set command "
diag debug flow trace stop
diag debug flow filter clear
diag debug console time disable
diag debug disable"
    next
end


# location-id is sent by branch to Hub during IKEv2 AUTH
# Use case: there are multiple IPsec tunnels from Branch terminated on the same dialup phase1-interface on Hub
# Hub's behavior:
# - all tunnels connecting to the same phase1-interface are grouped together if they have the same location-id.
# - In order to reply symmetrically, original incoming tunnel is cached in session.
# - For outgoing traffic, FOS does not necessarily use the tunnel returned by the routing lookup to send.
#   Instead, FOS tries to pick original incoming tunnel from the group to send.
#
# There is no real need for location-id in this PoC since no branch terminates multiple tunnels to the same phase1
# on the Hub. But I've configured location-id in a some kind of "provisioning" or "don't forget the feature" idea
# Here, I'm using the BGP RID as location-id
config system settings
    set location-id 10.0.2.1
end


# Internet and OOB management interfaces

config system interface
    edit "Internet_1"
        set vdom "root"
        set mode static
        set ip 100.64.41.2 255.255.255.0
        set allowaccess ping
        set alias "Internet-1"
        set interface "port1"
        set vlanid 41
    next
    edit "Internet_1_SNAT"
        set vdom "root"
        set mode static
        set ip 192.168.210.2 255.255.255.0
        set allowaccess ping
        set description "INET1 private IP for PAT/SNAT"
        set alias "Inet SNAT 100.64.41.210"
        set interface "port1"
        set vlanid 210
        set status down
    next
    edit "Internet_2"
        set vdom "root"
        set mode static
        set ip 100.64.42.2 255.255.255.0
        set allowaccess ping
        set alias "Internet-2"
        set interface "port1"
        set vlanid 42
    next
    edit "Internet_2_SNAT"
        set vdom "root"
        set mode static
        set ip 192.168.220.2 255.255.255.0
        set allowaccess ping
        set description "INET2 private IP for PAT/SNAT"
        set alias "Inet SNAT 100.64.42.220"
        set interface "port1"
        set vlanid 220
        set status down
    next
    edit "MPLS"
        set vdom "root"
        set mode static
        set ip 10.0.44.2 255.255.255.0
        set allowaccess ping
        set alias "MPLS"
        set interface "port2"
        set vlanid 44
    next
    edit "port5"
        set vdom "root"
        set mode static
        set ip 10.0.2.1 255.255.255.0
        set allowaccess ping
        set alias "LAN"
    next
end


# FW addresses and groups

config firewall address
    edit "LAN"
        set subnet 10.0.2.0 255.255.255.0
    next
    edit "W-DC1"
        set subnet 10.1.0.0 255.255.255.0
    next
    edit "W-DC2"
        set subnet 10.2.0.0 255.255.255.0
    next
    edit "E-DC3"
        set subnet 10.3.0.0 255.255.255.0
    next
    edit "Branches"
        set subnet 10.0.0.0 255.255.0.0
        set allow-routing enable
    next
    edit "Overlays"
        set subnet 10.200.0.0 255.252.0.0
        set allow-routing enable
    next
    edit "Overlay_INET1"
        set subnet 10.201.0.0 255.255.0.0
        set allow-routing enable
    next
    edit "Overlay_INET2"
        set subnet 10.202.0.0 255.255.0.0
        set allow-routing enable
    next
    edit "Overlay_MPLS"
        set subnet 10.203.0.0 255.255.0.0
        set allow-routing enable
    next
end

config firewall addrgrp
    edit "DataCenters"
        set member "W-DC1" "W-DC2" "E-DC3"
        set allow-routing enable
    next
    edit "Corporate"
        set member "Branches" "DataCenters" "Overlays"
        set allow-routing enable
    next
end

# IPsec

################ First DataCenter #############################################################

config vpn ipsec phase1-interface
    edit "H1_INET1"
        set interface "Internet_1"
        set ike-version 2
        set network-overlay enable
        
            set network-id 11
        
        set peertype any
        set localid "WEST-BR2_INET1"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        
            set remote-gw 100.64.11.1
        
         
            set psksecret 111111
        
    next
end

config vpn ipsec phase2-interface
    edit "H1_INET1"
        set phase1name "H1_INET1"
        set keepalive enable
    next
end

config system interface
    edit "H1_INET1"
        set allowaccess ping
    next
end


####

config vpn ipsec phase1-interface
    edit "H1_INET2"
        set interface "Internet_2"
        set ike-version 2
        set network-overlay enable
        
            set network-id 12
        
        set peertype any
        set localid "WEST-BR2_INET2"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        
            set remote-gw 100.64.12.1
        
         
            set psksecret 121212
        
    next
end

config vpn ipsec phase2-interface
    edit "H1_INET2"
        set phase1name "H1_INET2"
        set keepalive enable
    next
end

config system interface
    edit "H1_INET2"
        set allowaccess ping
    next
end


####

config vpn ipsec phase1-interface
    edit "H1_MPLS"
        set interface "MPLS"
        set ike-version 2
        set network-overlay enable
        
            set network-id 13
        
        set peertype any
        set localid "WEST-BR2_MPLS"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        
            set remote-gw 10.0.14.1
        
         
            set psksecret 131313
        
    next
end

config vpn ipsec phase2-interface
    edit "H1_MPLS"
        set phase1name "H1_MPLS"
        set keepalive enable
    next
end

config system interface
    edit "H1_MPLS"
        set allowaccess ping
    next
end

################ Second DataCenter ###########################################################

config vpn ipsec phase1-interface
    edit "H2_INET1"
        set interface "Internet_1"
        set ike-version 2
        set network-overlay enable
        
            set network-id 21
        
        set peertype any
        set localid "WEST-BR2_INET1"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        
            set remote-gw 100.64.21.2
        
         
            set psksecret 212121
        
    next
end

config vpn ipsec phase2-interface
    edit "H2_INET1"
        set phase1name "H2_INET1"
        set keepalive enable
    next
end

config system interface
    edit "H2_INET1"
        set allowaccess ping
        
    next
end


####

config vpn ipsec phase1-interface
    edit "H2_INET2"
        set interface "Internet_2"
        set ike-version 2
        set network-overlay enable
        
            set network-id 22
        
        set peertype any
        set localid "WEST-BR2_INET2"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        
            set remote-gw 100.64.22.2
        
         
            set psksecret 222222
        
    next
end

config vpn ipsec phase2-interface
    edit "H2_INET2"
        set phase1name "H2_INET2"
        set keepalive enable
    next
end

config system interface
    edit "H2_INET2"
        set allowaccess ping
        
    next
end


####

config vpn ipsec phase1-interface
    edit "H2_MPLS"
        set interface "MPLS"
        set ike-version 2
        set network-overlay enable
        
            set network-id 23
        
        set peertype any
        set localid "WEST-BR2_MPLS"
        set net-device enable
        set auto-discovery-receiver enable
        set add-route disable
        set mode-cfg enable
        set dpd on-idle
        set dpd-retryinterval 5
        set idle-timeout enable
        set idle-timeoutinterval 5
        set suite-b suite-b-gcm-128
        
            set remote-gw 10.0.24.2
        
         
            set psksecret 232323
        
    next
end

config vpn ipsec phase2-interface
    edit "H2_MPLS"
        set phase1name "H2_MPLS"
        set keepalive enable
    next
end

config system interface
    edit "H2_MPLS"
        set allowaccess ping
        
    next
end


# SD-WAN



# 'set hold-down-time 20' to prevent falling back to most-preferred shortcut before measuring its quality
#

# FOS 7.0+
# 'set tie-break fib-best-match' to select path with best-route to another shortcut instead of
# going back to feasible routes via Hub


config system sdwan
    set status enable
    config zone
        edit "internet"
        next
        edit "overlay"
        next
    end
    config members
        edit 1
            set interface "Internet_1"
            set zone "internet"
            set gateway 100.64.41.254
        next
        edit 2
            set interface "Internet_2"
            set zone "internet"
            set gateway 100.64.42.254
        next

        edit 11
            set interface "H1_INET1"
            set zone "overlay"
            
            set priority 10
        next
        edit 12
            set interface "H1_INET2"
            set zone "overlay"
            
            set priority 10
        next
        edit 13
            set interface "H1_MPLS"
            set zone "overlay"
            
            set priority 10
        next
        edit 21
            set interface "H2_INET1"
            set zone "overlay"
            
            set priority 10
        next
        edit 22
            set interface "H2_INET2"
            set zone "overlay"
            
            set priority 10
        next
        edit 23
            set interface "H2_MPLS"
            set zone "overlay"
            
            set priority 10
        next
    end
    config health-check
        edit "SLA_DataCenters"
            set server "10.200.99.1"
            set sla-fail-log-period 10
            set sla-pass-log-period 10
            set members 11 12 13 21 22 23
            config sla
                edit 1
                    set link-cost-factor latency
                    set latency-threshold 150
                next
            end
        next
        edit "SLA_Internet"
            set server "198.18.8.8"
            set sla-fail-log-period 10
            set sla-pass-log-period 10
            
            
                set members 1 2 13 23
            
            
            config sla
                edit 1
                    set link-cost-factor latency
                    set latency-threshold 150
                next
                edit 2
                    set link-cost-factor latency
                    set latency-threshold 300
                next
            end
        next
        edit "SLA_inet1"
            set server "100.64.41.254"
            set sla-fail-log-period 10
            set sla-pass-log-period 10
            set members 1
            config sla
                edit 1
                    set link-cost-factor latency
                    set latency-threshold 150
                next
            end
        next
        edit "SLA_inet2"
            set server "100.64.42.254"
            set sla-fail-log-period 10
            set sla-pass-log-period 10
            set members 2
            config sla
                edit 1
                    set link-cost-factor latency
                    set latency-threshold 150
                next
            end
        next
    end
    config service
        edit 1
            set name "Corporate_SSH"
            set mode priority
            set src "LAN"
                set hold-down-time 20
            
                set tie-break fib-best-match
            
            set internet-service enable
            set internet-service-app-ctrl 16060
            set health-check "SLA_DataCenters"
            set priority-members 11 12
        next
        edit 2
            set name "Corporate_PING"
            set mode sla
            set src "LAN"
                set hold-down-time 20
            
                set tie-break fib-best-match
            
            set internet-service enable
            set internet-service-app-ctrl 24466
            set hold-down-time 20
            config sla
                edit "SLA_DataCenters"
                    set id 1
                next
            end
            set priority-members 12 11
        next
        edit 3
            
                set name "Corporate_via_DC1"
            
            set mode sla
            set dst "Corporate"
            set src "LAN"
                set hold-down-time 20
            
                set tie-break fib-best-match
            
            config sla
                edit "SLA_DataCenters"
                    set id 1
                next
            end
            set priority-members 11 12 13
        next
        edit 4
            
                set name "Corporate_via_DC2"
            
            set mode sla
            set dst "Corporate"
            set src "LAN"
                set hold-down-time 20
            
                set tie-break fib-best-match
            
            config sla
                edit "SLA_DataCenters"
                    set id 1
                next
            end
            set priority-members 21 22 23
        next
        edit 5
            set name "Internet_HighPriority"
            set mode sla
            set src "LAN"
            set internet-service enable
            set internet-service-app-ctrl 16354 16920
            config sla
                edit "SLA_Internet"
                    set id 1
                next
            end
            
            
                set priority-members 1 2 13 23
            
            
        next
        edit 6
            set name "Internet_MedPriority"
            set mode sla
            set src "LAN"
            set internet-service enable
            set internet-service-app-ctrl 33182 41468
            config sla
                edit "SLA_Internet"
                    set id 2
                next
            end
            
            
                set priority-members 1 2 13 23
            
            
        next
        edit 7
            set name "Internet"
            set mode sla
            set src "LAN"
            set dst "all"
            config sla
                edit "SLA_Internet"
                    set id 2
                next
            end
            set priority-members 2 1
        next
    end
end

# SD-WAN rules for Overlay:
# ------------------------
# rules 1 and 2 leverages AppCtrl routing while rule 3 has no AppCtrl
# during learning phase, rule 1 and 2 cannot be matched which means learning traffic hits rule 3
# and can get sent out members "11 12 13 14" depending on SLA conditions
# learning traffic will hit firewall policy 3 (Corporate Out) which has AppCtrl enabled
# and therefore allows to populate 5-tuple for appctrl isdb cache
#
# SD-WAN rules for Internet underlay:
# ----------------------------------
# rules 5 and 6 (members 1 2 13 23) leverage AppCtrl routing while rule 7 (members 1 2) has no AppCtrl
# during learning phase, rule 5 and 6 cannot be matched which means learning traffic hits rule 7
# and can get sent out members "1 2" (DIA) depending on SLA conditions
# learning traffic will hit firewall policy 2 (Internet DIA) which has AppCtrl enabled
# and therefore allows to populate 5-tuple for appctrl isdb cache
# subsequent traffic to dstip-dport in appctrl cache can hit sdwan rules 5 or 6 and can be sent out members "1 2 13 23"
# depending on SLA conditions and can be allowed by firewall policies 2 (Internet DIA) or 5 (Internet RIA)
# AppCtrl is enabled on firewall policy 5 (Internet RIA) because if all DIA Internet links go down
# then traffic will hit FIB (rule 7 is ignored) and will hit RIA FW policy 5.
# If no AppCtrl was configured on RIA FW policy 5 then all Internet traffic will be subject to regular FIB lookup
# and sdwan rules 5/6 (prefer H1_MPLS over H2_MPLS) would never be matched since 5-tuple would never be populated
#
# A rule of thumb could be: Enable AppCtrl on all FW policies which have egress interfaces that leverage AppCtrl routing at sdwan layer.

# FW Policies
# no IPS profile is applied because IPS process did not start correctly when mixing AppCtrl + IPS profiles

config firewall policy
    edit 1
        set name "Deny Internet"
        set srcintf "port5"
        set dstintf "internet"
        set srcaddr "RFC1918-private-subnets"
        set dstaddr "RFC1918-private-subnets"
        set schedule "always"
        set service "ALL"
        set logtraffic all
        set comments "Good practice FW rule"
    next
    edit 2
        set name "Internet (DIA)"
        set srcintf "port5"
        set dstintf "internet"
        set srcaddr "LAN"
        set dstaddr "all"
        set action accept
        set schedule "always"
        set service "ALL"
        set utm-status enable
        set ssl-ssh-profile "deep-inspection"
        set av-profile "default"
        set application-list "default"
        set logtraffic all
        set nat enable
    next
    edit 3
        set name "Corporate Out"
        set srcintf "port5"
        set dstintf "overlay"
        set srcaddr "LAN"
        set dstaddr "Corporate"
        set action accept
        set utm-status enable
        set ssl-ssh-profile "deep-inspection"
        set application-list "default"
        set schedule "always"
        set service "ALL"
        set logtraffic all
    next

    edit 5
        set name "Internet (RIA)"
        set srcintf "port5"
        set dstintf "overlay"
        set srcaddr "LAN"
        set dstaddr "all"
        set action accept
        set utm-status enable
        set ssl-ssh-profile "deep-inspection"
        set application-list "default"
        set schedule "always"
        set service "ALL"
        set logtraffic all
        set comments "Remote Internet Breakout - no NAT"
    next

    edit 4
        set name "Corporate In"
        set srcintf "overlay"
        set dstintf "port5"
        set srcaddr "Corporate"
        set dstaddr "LAN"
        set action accept
        set schedule "always"
        set service "ALL"
        set logtraffic all
        set comments "no UTM inbound - it is applied outbound"
    next
end


## Routing


# Static default-routes

    
    config router static
        edit 1
            set sdwan-zone "internet" "overlay"
            set comment "Default-route via Internet and all overlays"
        next
    end
    
    



# MPLS underlay
config router static
    edit 3
        set dstaddr "MPLS_Underlay"
        set device "MPLS"
        set gateway 10.0.44.254
        set comment "MPLS underlay"
    next
end





# In FOS 6.4, a shortcut can be less preferred than its parent interface if shortcut SLA monitoring fails the SLA target
# If there is a feasible route towards the corporate subnets via the parent interface
# then traffic does not fallback to another overlay, it stays on this parent interface
# For 7.0+, fib-best-match can be used but for 6.4 we must ensure no feasible route is valid over the parent by using
# a blackhole route



# BGP peerings over VPN overlays

config router bgp
    
        set as 65012
    
    set router-id 10.0.2.1
    set keepalive-timer 10
    set holdtime-timer 30
    set ibgp-multipath enable
    
        set recursive-next-hop enable
    
    config neighbor
    
        edit "10.201.1.254"
    
            set interface "H1_INET1"
            
                set remote-as 65012
            
            set additional-path receive
            set connect-timer 1
            set advertisement-interval 1
            set link-down-failover enable
            set soft-reconfiguration enable
        next
    
        edit "10.202.1.254"
    
            set interface "H1_INET2"
            
                set remote-as 65012
            
            set additional-path receive
            set connect-timer 1
            set advertisement-interval 1
            set link-down-failover enable
            set soft-reconfiguration enable
        next
    
        edit "10.203.1.254"
    
            set interface "H1_MPLS"
            
                set remote-as 65012
            
            set additional-path receive
            set connect-timer 1
            set advertisement-interval 1
            set link-down-failover enable
            set soft-reconfiguration enable
        next
    
        edit "10.201.2.254"
    
            set interface "H2_INET1"
            
                set remote-as 65012
            
            set additional-path receive
            set connect-timer 1
            set advertisement-interval 1
            set link-down-failover enable
            set soft-reconfiguration enable
        next
    
        edit "10.202.2.254"
    
            set interface "H2_INET2"
            
                set remote-as 65012
            
            set additional-path receive
            set connect-timer 1
            set advertisement-interval 1
            set link-down-failover enable
            set soft-reconfiguration enable
        next
    
        edit "10.203.2.254"
    
            set interface "H2_MPLS"
            
                set remote-as 65012
            
            set additional-path receive
            set connect-timer 1
            set advertisement-interval 1
            set link-down-failover enable
            set soft-reconfiguration enable
        next
    end
    config network
        edit 1
            set prefix 10.0.2.0 255.255.255.0
        next
    end
end

#
# BGP routes
#










# FGT-W-BR2 # alias bgp_rib
# Routing table for VRF=0
# B       10.0.1.0/24 [200/0] via 10.201.1.1 [3] (recursive via H1_INET1 tunnel 100.64.11.1), 00:57:51
#                     [200/0] via 10.202.1.1 [3] (recursive via H1_INET2 tunnel 100.64.12.1), 00:57:51
#                     [200/0] via 10.203.1.1 [3] (recursive via H1_MPLS tunnel 10.0.14.1), 00:57:51
#                     [200/0] via 10.201.2.1 [3] (recursive via H2_INET1 tunnel 100.64.21.2), 00:57:51
#                     [200/0] via 10.202.2.1 [3] (recursive via H2_INET2 tunnel 100.64.22.2), 00:57:51
#                     [200/0] via 10.203.2.1 [3] (recursive via H2_MPLS tunnel 10.0.24.2), 00:57:51
# B       10.0.3.0/24 [200/0] via 10.201.3.1 [6] (recursive via H1_INET1 tunnel 100.64.11.1), 00:25:31
#                                                (recursive via H2_INET1 tunnel 100.64.21.2), 00:25:31
#                     [200/0] via 10.202.3.1 [6] (recursive via H1_INET2 tunnel 100.64.12.1), 00:25:31
#                                                (recursive via H2_INET2 tunnel 100.64.22.2), 00:25:31
#                     [200/0] via 10.203.3.1 [6] (recursive via H1_MPLS tunnel 10.0.14.1), 00:25:31
#                                                (recursive via H2_MPLS tunnel 10.0.24.2), 00:25:31
# B       10.1.0.0/24 [200/0] via 10.201.1.254 (recursive via H1_INET1 tunnel 100.64.11.1), 00:57:51
#                     [200/0] via 10.202.1.254 (recursive via H1_INET2 tunnel 100.64.12.1), 00:57:51
#                     [200/0] via 10.203.1.254 (recursive via H1_MPLS tunnel 10.0.14.1), 00:57:51
# B       10.2.0.0/24 [200/0] via 10.201.2.254 (recursive via H2_INET1 tunnel 100.64.21.2), 00:57:52
#                     [200/0] via 10.202.2.254 (recursive via H2_INET2 tunnel 100.64.22.2), 00:57:52
#                     [200/0] via 10.203.2.254 (recursive via H2_MPLS tunnel 10.0.24.2), 00:57:52
# B       10.3.0.0/24 [200/0] via 10.201.13.2 [3] (recursive via H1_INET1 tunnel 100.64.11.1), 00:25:31
#                                                 (recursive via H2_INET1 tunnel 100.64.21.2), 00:25:31
#                     [200/0] via 10.202.13.2 [3] (recursive via H1_INET2 tunnel 100.64.12.1), 00:25:31
#                                                 (recursive via H2_INET2 tunnel 100.64.22.2), 00:25:31
#                     [200/0] via 10.203.13.2 [3] (recursive via H1_MPLS tunnel 10.0.14.1), 00:25:31
#                                                 (recursive via H2_MPLS tunnel 10.0.24.2), 00:25:31
#                     [200/0] via 10.201.23.2 [3] (recursive via H1_INET1 tunnel 100.64.11.1), 00:25:31
#                                                 (recursive via H2_INET1 tunnel 100.64.21.2), 00:25:31
#                     [200/0] via 10.202.23.2 [3] (recursive via H1_INET2 tunnel 100.64.12.1), 00:25:31
#                                                 (recursive via H2_INET2 tunnel 100.64.22.2), 00:25:31
#                     [200/0] via 10.203.23.2 [3] (recursive via H1_MPLS tunnel 10.0.14.1), 00:25:31
#                                                 (recursive via H2_MPLS tunnel 10.0.24.2), 00:25:31
# B       10.200.0.0/14 [200/0] via 10.201.1.254 (recursive via H1_INET1 tunnel 100.64.11.1), 00:57:48
#                       [200/0] via 10.202.1.254 (recursive via H1_INET2 tunnel 100.64.12.1), 00:57:48
#                       [200/0] via 10.203.1.254 (recursive via H1_MPLS tunnel 10.0.14.1), 00:57:48
#                       [200/0] via 10.201.2.254 (recursive via H2_INET1 tunnel 100.64.21.2), 00:57:48
#                       [200/0] via 10.202.2.254 (recursive via H2_INET2 tunnel 100.64.22.2), 00:57:48
#                       [200/0] via 10.203.2.254 (recursive via H2_MPLS tunnel 10.0.24.2), 00:57:48
# B       10.201.0.0/16 [200/0] via 10.201.1.254 (recursive via H1_INET1 tunnel 100.64.11.1), 00:57:48
#                       [200/0] via 10.201.2.254 (recursive via H2_INET1 tunnel 100.64.21.2), 00:57:48
# B       10.202.0.0/16 [200/0] via 10.202.1.254 (recursive via H1_INET2 tunnel 100.64.12.1), 00:57:48
#                       [200/0] via 10.202.2.254 (recursive via H2_INET2 tunnel 100.64.22.2), 00:57:48
# B       10.203.0.0/16 [200/0] via 10.203.1.254 (recursive via H1_MPLS tunnel 10.0.14.1), 00:57:48
#                       [200/0] via 10.203.2.254 (recursive via H2_MPLS tunnel 10.0.24.2), 00:57:48
















