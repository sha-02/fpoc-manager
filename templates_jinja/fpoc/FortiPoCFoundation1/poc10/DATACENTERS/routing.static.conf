{% if FMG_FORTIGATE_ID %}
    {% import 'SETTINGS.DEVICES' as SETTINGS with context %}

    {% set FOS = SETTINGS.DEVICES[FMG_FORTIGATE_ID].FOS %}
    {% set region = SETTINGS.DEVICES[FMG_FORTIGATE_ID].region %}
    {% set wan = SETTINGS.DEVICES[FMG_FORTIGATE_ID].wan %}
    {% set cross_region_advpn = SETTINGS.DEVICES[FMG_FORTIGATE_ID].cross_region_advpn %}
{% endif %}
#########################################################################################

# Static default-routes

config router static
    edit 1
        unset gateway
        unset device
        set sdwan-zone "internet"
        set comment "Default-route via Internet links"
    next
    edit 101
        set dstaddr "Corporate"
        set blackhole enable
        set comment "Avoid potential leak of corporate traffic to underlay"
    next
    edit 102
        set dstaddr "lo-BGP-all-regions"
        set blackhole enable
        set comment "Avoid potential recursive resolution of corporate BGP routes via underlay"
    next
    {% if cross_region_advpn %}
        edit 103
            set dstaddr "lo-BGP-{{region}}-region"
            set blackhole enable
            set comment "Regional loopback summary"
        next
    {% endif %}
end

# MPLS underlay

config router static
    edit 3
        set dstaddr "MPLS_Underlay"
        set device "MPLS"
        set gateway {{wan.mpls1.subnet}}.254
        set comment "MPLS underlay"
    next
end
