config system global
    {% if HA.role.name == 'SECONDARY' %}  {# no config script deployed to secondary members, so hostname is set directly in bootstrap #}
        set hostname "{{HA.group_name}}" {# group_name is actually the device name when pushing bootstrap config #}
    {% else %}
        set hostname "BOOTSTRAP_CONFIG_{{name}}"
    {% endif %}
    {{ "set alias %s"%alias if alias }}
    set admin-scp enable  {# Allows to upload  config file or firmware via SCP #}
    set admin-https-redirect disable
    set admintimeout 480
    set admin-lockout-duration 10
    set admin-lockout-threshold 10
    set gui-display-hostname enable {# display the FGT hostname on the GUI login page #}
    set lldp-reception enable
    set lldp-transmission enable
    {% if FOS >= 7_002_001 %}
      set gui-app-detection-sdwan enable  {# Applications as SD-WAN rule destinations #}
    {% endif %}
    {% if FOS <= 7_004_001 %}
      set timezone 28
    {% else %}
      set timezone "Europe/Paris"
    {% endif %}
end

config system settings
    set gui-allow-unnamed-policy enable
    set gui-multiple-interface-policy enable
end

config system console
    set output standard
end

config system dns
    set primary {{mgmt_dns}}
    set protocol cleartext
end

config system fortiguard
    set update-server-location eu
end

{% if FOS >= 6_002_000 %}
config system admin
    edit "admin"
        set password {{password}}
    next
end
{% endif %}

config system api-user
    edit "{{apiadmin}}"
        set accprofile "super_admin"
        set vdom "root"
#        config trusthost
#            edit 1
#                set ipv4-trusthost {{mgmt.network}}
#            next
#        end
    next
end

{% if (FOS >= 7_004_005 and FOS < 7_006_000) or FOS >= 7_006_001 %}
# As of 7.6.1/7.4.5 (1058092), use of REST API keys in the URL (as a query parameter) is controlled by a CLI setting
# (rest-api-key-url-query in system.global) which is disabled by default
# The plan may be to completely remove the ability to use API key in URL in future FOS release
# For the time being, the bootstrap config is updated: this setting is configured to enable API in URL.

config system global
    set rest-api-key-url-query enable
end
{% endif %}
