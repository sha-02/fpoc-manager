{# OOB management interface #}

{% if mgmt.vlanid == 0 %}
    config system interface
        edit "{{mgmt.interface}}"
            set vdom "root"
            set mode static
            set ip {{mgmt.ipmask}}
            set allowaccess ping https ssh http telnet fgfm
            set alias "OOB Management"
        next
    end
{% else %}
    config system interface
        edit "OOB_MGMT"
            set vdom "root"
            set interface "{{mgmt.interface}}"
            set vlanid {{mgmt.vlanid}}
            set mode static
            set ip {{mgmt.ipmask}}
            set allowaccess ping https ssh http telnet fgfm
            set alias "OOB Management"
        next
    end
{% endif %}

{# WAN Underlay interfaces #}

{% if WAN_underlays %}
config system interface
    {% for ifname, wan in WAN %}
        {% if wan.vlanid == 0 %} {# no VLAN #}
            edit "{{wan.port}}"
                set vdom "root"
                set mode static
                set ip {{wan.subnet}}.{{ip_lastbyte}} 255.255.255.0
                set allowaccess ping
                set role wan
                set alias "{{ifname}}"
            next
        {% else %}
            edit "{{ifname}}"
                set vdom "root"
                set interface "{{wan.port}}"
                set vlanid {{wan.vlanid}}
                set mode static
                set ip {{wan.subnet}}.{{ip_lastbyte}} 255.255.255.0
                set allowaccess ping
                set role wan
            next
        {% endif %}
    {% endfor %}
end
{% endif %}
